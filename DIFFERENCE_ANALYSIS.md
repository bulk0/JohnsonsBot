# üîç –ê–ù–ê–õ–ò–ó –†–ê–ó–õ–ò–ß–ò–ô: johnson_weights.py vs imputations_v2.py

## üìÖ –î–∞—Ç–∞: 9 –æ–∫—Ç—è–±—Ä—è 2025

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã **–í–°–Å –ï–©–Å —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è** –º–µ–∂–¥—É –±–æ—Ç–æ–º (`johnson_weights.py`) –∏ `imputations_v2.py`.

## üîç –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –†–ê–ó–õ–ò–ß–ò–Ø –í –õ–û–ì–ò–ö–ï

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

#### –ë–û–¢ (johnson_weights.py):
```python
# –§—É–Ω–∫—Ü–∏—è hybrid_imputation() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç extended_vars
extended_vars = independent_vars + [f'{var}_missing' for var in independent_vars]
# –û–î–ò–ù —Å–ø–∏—Å–æ–∫ –Ω–∞ –í–°–ï –∏–º–ø—É—Ç–∞—Ü–∏–∏!
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** `extended_vars` —Å–æ–∑–¥–∞–µ—Ç—Å—è **–û–î–ò–ù –†–ê–ó** –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–í–°–ï–•** –∏–º–ø—É—Ç–∞—Ü–∏–π.

#### imputations_v2.py:
```python
# –í–ù–£–¢–†–ò —Ü–∏–∫–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏:
for imp_idx, imp_df in enumerate(imputed_dfs):
    # –°–æ–∑–¥–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –î–õ–Ø –ö–ê–ñ–î–û–ô –∏–º–ø—É—Ç–∞—Ü–∏–∏
    extended_indep_vars = independent_vars + [f"{var}_missing" for var in independent_vars]
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** `extended_indep_vars` —Å–æ–∑–¥–∞–µ—Ç—Å—è **–î–õ–Ø –ö–ê–ñ–î–û–ô** –∏–º–ø—É—Ç–∞—Ü–∏–∏ –∑–∞–Ω–æ–≤–æ.

---

### 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

#### –ë–û–¢ (johnson_weights.py):
```python
# –í calculate_weights():
vars_to_use = use_extended_vars  # –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Å–ø–∏—Å–æ–∫ –¥–ª—è –≤—Å–µ—Ö
X = analysis_data[vars_to_use].values

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ü–û–°–õ–ï –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
std_vars = np.std(X, axis=0)
valid_indices = [i for i, std in enumerate(std_vars) if std > 0]
X = X[:, valid_indices]
valid_vars = [vars_to_use[i] for i in valid_indices]

# –†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤ –¥–ª—è valid_vars
imp_results = johnson_relative_weights(X, y)

# –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –∫–ª—é—á–∏: Weight_var1, Weight_var2, ...
# –ù–û —Ç–æ–ª—å–∫–æ –¥–ª—è VALID_VARS!
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** 
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ numpy-–º–∞—Å—Å–∏–≤–æ–≤
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –≤–µ—Å–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è **valid_vars**
- –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∞ –≤ –∫–∞–∫–æ–π-—Ç–æ –∏–º–ø—É—Ç–∞—Ü–∏–∏ - –æ–Ω–∞ –ù–ï –ø–æ–ø–∞–¥–µ—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏

#### imputations_v2.py:
```python
# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –î–û —Ä–∞—Å—á–µ—Ç–∞
std_vars = working_df[extended_indep_vars].std()
constant_vars = std_vars[std_vars == 0].index.tolist()

if constant_vars:
    valid_indep_vars = [var for var in extended_indep_vars if var not in constant_vars]
else:
    valid_indep_vars = extended_indep_vars

# –†–∞—Å—á–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è valid_indep_vars
X = working_df[valid_indep_vars].values
imp_results = johnson_relative_weights(X, y)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ valid_indep_vars –¥–ª—è —ç—Ç–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏
all_imp_results.append({
    'variables': valid_indep_vars,  # ‚Üê –ú–û–ñ–ï–¢ –ë–´–¢–¨ –†–ê–ó–ù–´–ú –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏–º–ø—É—Ç–∞—Ü–∏–π!
    'rweights': imp_results['rweights'],
    'percentages': imp_results['percentages']
})
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:**
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ DataFrame
- `valid_indep_vars` **–ú–û–ñ–ï–¢ –†–ê–ó–õ–ò–ß–ê–¢–¨–°–Ø** –º–µ–∂–¥—É –∏–º–ø—É—Ç–∞—Ü–∏—è–º–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–≤–æ–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

---

### 3. –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –†–ê–ó–ù–ò–¶–ê: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### –ë–û–¢ (johnson_weights.py):
```python
# –°–æ–±–∏—Ä–∞–µ–º –≤–µ—Å–∞ –¥–ª—è –§–ò–ö–°–ò–†–û–í–ê–ù–ù–û–ì–û —Å–ø–∏—Å–∫–∞ extended_vars
for var in extended_vars:  # ‚Üê –û–î–ò–ù–ê–ö–û–í–´–ô –¥–ª—è –≤—Å–µ—Ö –∏–º–ø—É—Ç–∞—Ü–∏–π
    if var not in hybrid_weights:
        hybrid_weights[var] = []
        hybrid_percentages[var] = []
    
    weight_key = f'Weight_{var}'
    pct_key = f'Percentage_{var}'
    if weight_key in hybrid_results and pct_key in hybrid_results:
        hybrid_weights[var].append(hybrid_results[weight_key])
        hybrid_percentages[var].append(hybrid_results[pct_key])
    # –ò–ù–ê–ß–ï - –≤ —Å–ø–∏—Å–æ–∫ –ù–ï –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–∏—á–µ–≥–æ!

# –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –í–°–ï –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç –≤–µ—Å–∞
all_vars_have_weights = True
for var in extended_vars:
    if var in hybrid_weights and hybrid_weights[var]:  # ‚Üê –°–ø–∏—Å–æ–∫ –ù–ï –ü–£–°–¢–û–ô?
        avg_results[f'Weight_{var}'] = np.mean(hybrid_weights[var])
    else:
        all_vars_have_weights = False  # ‚Üê –ü–†–û–í–ê–õ!

if all_vars_have_weights:
    results_hybrid.append(avg_results)  # ‚Üê –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
else:
    # ‚ùå –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ù–ï –î–û–ë–ê–í–õ–Ø–Æ–¢–°–Ø –í–û–û–ë–©–ï!
    print("\n‚ùå HYBRID RESULTS SKIPPED due to missing weights")
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ï—Å–ª–∏ **–•–û–¢–Ø –ë–´ –û–î–ù–ê** –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∏–∑ `extended_vars` –Ω–µ –∏–º–µ–µ—Ç –≤–µ—Å–æ–≤ **–í–û –í–°–ï–•** –∏–º–ø—É—Ç–∞—Ü–∏—è—Ö
- –¢–æ `all_vars_have_weights = False`
- –ò —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã **–ù–ï –î–û–ë–ê–í–õ–Ø–Æ–¢–°–Ø –í –§–ê–ô–õ** –≤–æ–æ–±—â–µ!

#### imputations_v2.py:
```python
# –°–Ω–∞—á–∞–ª–∞ —Å–æ–±–∏—Ä–∞–µ–º –í–°–ï —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –í–°–ï–• –∏–º–ø—É—Ç–∞—Ü–∏–π
all_variables = set()
for imp_result in all_imp_results:
    all_variables.update(imp_result['variables'])  # ‚Üê –û–ë–™–ï–î–ò–ù–ï–ù–ò–ï (union)
all_variables = sorted(list(all_variables))

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –í–°–ï–• –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
combined_weights = {var: [] for var in all_variables}
combined_percentages = {var: [] for var in all_variables}

# –°–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
for imp_result in all_imp_results:
    for i, var in enumerate(imp_result['variables']):
        combined_weights[var].append(imp_result['rweights'][i])
        combined_percentages[var].append(imp_result['percentages'][i])
    # –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ—Ç –≤ —ç—Ç–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏ - –Ω–∏—á–µ–≥–æ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –µ–µ —Å–ø–∏—Å–æ–∫

# –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—É—Å—Ç—ã—Ö —Å–ø–∏—Å–∫–æ–≤
for var in all_variables:
    weights = combined_weights[var]
    if weights:  # –°–ø–∏—Å–æ–∫ –ù–ï –ø—É—Å—Ç–æ–π
        avg_weights[var] = np.mean(weights)
    else:  # –°–ø–∏—Å–æ–∫ –ø—É—Å—Ç–æ–π (–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ –±—ã–ª–æ –Ω–∏ –≤ –æ–¥–Ω–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏)
        avg_weights[var] = 0  # ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ–º 0!

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –í–°–ï–ì–î–ê –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è
weights_dict = {...}
for var in all_variables:
    weights_dict[f'Weight_{var}'] = avg_weights[var]
results.append(weights_dict)  # ‚Üê –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ–º!
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–û–ë–™–ï–î–ò–ù–ï–ù–ò–ï** –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ –≤—Å–µ—Ö –∏–º–ø—É—Ç–∞—Ü–∏–π
- –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±—ã–ª–∞ —Ç–æ–ª—å–∫–æ –≤ –ß–ê–°–¢–ò –∏–º–ø—É—Ç–∞—Ü–∏–π - –±–µ—Ä–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–µ–µ –ø–æ —Ç–µ–º, –≥–¥–µ –æ–Ω–∞ –±—ã–ª–∞
- –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ –±—ã–ª–æ –ù–ò –í –û–î–ù–û–ô –∏–º–ø—É—Ç–∞—Ü–∏–∏ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 0
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã **–í–°–ï–ì–î–ê –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è**

---

## üìä –ü–†–ò–ú–ï–†: –ü–æ—á–µ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è

### –°—Ü–µ–Ω–∞—Ä–∏–π:
–£ –≤–∞—Å 5 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: q1, q2, q3, q4, q5
–ü–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è 10 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: q1, q2, q3, q4, q5, q1_missing, q2_missing, q3_missing, q4_missing, q5_missing

**–ò–º–ø—É—Ç–∞—Ü–∏—è 1:**
- –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç –¥–∏—Å–ø–µ—Ä—Å–∏—é > 0
- valid_vars = [q1, q2, q3, q4, q5, q1_missing, q2_missing, q3_missing, q4_missing, q5_missing]
- –ü–æ–ª—É—á–µ–Ω—ã –≤–µ—Å–∞ –¥–ª—è –≤—Å–µ—Ö 10 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–ò–º–ø—É—Ç–∞—Ü–∏—è 2:**
- q3_missing –æ–∫–∞–∑–∞–ª–∞—Å—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–π (–≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è = 0, —Ç.–∫. –≤ —ç—Ç–æ–π –≤—ã–±–æ—Ä–∫–µ –Ω–µ –±—ã–ª–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ q3)
- valid_vars = [q1, q2, q3, q4, q5, q1_missing, q2_missing, q4_missing, q5_missing]
- –ü–æ–ª—É—á–µ–Ω—ã –≤–µ—Å–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è 9 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–Ω–µ—Ç q3_missing)

### –†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–û–¢–ï (johnson_weights.py):

```python
extended_vars = [q1, q2, q3, q4, q5, q1_missing, q2_missing, q3_missing, q4_missing, q5_missing]

# –ü–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ 1:
hybrid_weights['q3_missing'] = [0.0045]  # –µ—Å—Ç—å –≤–µ—Å

# –ü–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ 2:
# 'Weight_q3_missing' –ù–ï –≤ hybrid_results
# hybrid_weights['q3_missing'] –æ—Å—Ç–∞–µ—Ç—Å—è [0.0045]  # —Ç–æ–ª—å–∫–æ 1 –∑–Ω–∞—á–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ 2!

# –ü—Ä–∏ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–∏:
for var in extended_vars:
    if var == 'q3_missing':
        if hybrid_weights['q3_missing']:  # [0.0045] - –Ω–µ –ø—É—Å—Ç–æ–π
            # –ù–æ –¥–ª–∏–Ω–∞ —Å–ø–∏—Å–∫–∞ = 1, –∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 2
            # –°—Ä–µ–¥–Ω–µ–µ = np.mean([0.0045]) = 0.0045
            # –ù–û! –û–∂–∏–¥–∞–ª–æ—Å—å 2 –∑–Ω–∞—á–µ–Ω–∏—è

# –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç, –ù–û:
# –°—Ä–µ–¥–Ω–µ–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –û–î–ù–û–ô –∏–º–ø—É—Ç–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ –î–í–£–•!
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –í–µ—Å–∞ –¥–ª—è `q3_missing` —É—Å—Ä–µ–¥–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ —Ç–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏, –≥–¥–µ –æ–Ω–∏ –±—ã–ª–∏, —á—Ç–æ **–∏—Å–∫–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**.

### –†–µ–∑—É–ª—å—Ç–∞—Ç –≤ imputations_v2.py:

```python
# –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –∏–º–ø—É—Ç–∞—Ü–∏–π:
all_variables = {q1, q2, q3, q4, q5, q1_missing, q2_missing, q3_missing, q4_missing, q5_missing}

# –ò–º–ø—É—Ç–∞—Ü–∏—è 1:
combined_weights['q3_missing'] = [0.0045]

# –ò–º–ø—É—Ç–∞—Ü–∏—è 2:
# q3_missing –Ω–µ—Ç –≤ imp_result['variables']
# combined_weights['q3_missing'] –æ—Å—Ç–∞–µ—Ç—Å—è [0.0045]

# –ü—Ä–∏ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–∏:
weights = combined_weights['q3_missing']  # [0.0045]
if weights:
    avg_weights['q3_missing'] = np.mean([0.0045]) = 0.0045
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–∞ –∂–µ - —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–æ —á–∞—Å—Ç–∏ –∏–º–ø—É—Ç–∞—Ü–∏–π.

---

## üéØ –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê –†–ê–ó–õ–ò–ß–ò–ô

### –í –±–æ—Ç–µ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å —Å–∏—Ç—É–∞—Ü–∏—è:
1. extended_vars = [q1, q2, ..., q5_missing] - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
2. –í –∫–∞–∫–æ–π-—Ç–æ –∏–º–ø—É—Ç–∞—Ü–∏–∏ –æ–¥–Ω–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∞
3. –≠—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ù–ï –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏
4. **–ï–°–õ–ò** –ø—Ä–æ–≤–µ—Ä–∫–∞ `all_vars_have_weights` —Å—Ç—Ä–æ–≥–∞—è ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ù–ï –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è
5. –í Excel –ù–ï–¢ —Å—Ç—Ä–æ–∫–∏ —Å Hybrid —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

### –í imputations_v2.py:
1. all_variables —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –≤—Å–µ—Ö –∏–º–ø—É—Ç–∞—Ü–∏–π (union)
2. –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ —Ç–µ–º –∏–º–ø—É—Ç–∞—Ü–∏—è–º, –≥–¥–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞
3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã **–í–°–ï–ì–î–ê** –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è
4. –í Excel –ï–°–¢–¨ —Å—Ç—Ä–æ–∫–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### –û–ø—Ü–∏—è 1: –°–¥–µ–ª–∞—Ç—å –±–æ—Ç –º—è–≥—á–µ (–∫–∞–∫ imputations_v2)

–ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ `johnson_weights.py`:
```python
# –í–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:
if all_vars_have_weights:
    results_hybrid.append(avg_results)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
for var in extended_vars:
    if var in hybrid_weights and hybrid_weights[var]:
        avg_results[f'Weight_{var}'] = np.mean(hybrid_weights[var])
    else:
        avg_results[f'Weight_{var}'] = 0  # ‚Üê –ó–∞–º–µ–Ω—è–µ–º –Ω–∞ 0
        avg_results[f'Percentage_{var}'] = 0

# –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
results_hybrid.append(avg_results)
```

### –û–ø—Ü–∏—è 2: –°–¥–µ–ª–∞—Ç—å imputations_v2 —Å—Ç—Ä–æ–∂–µ (–∫–∞–∫ –±–æ—Ç)

```python
# –ü–æ—Å–ª–µ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç –≤–µ—Å–∞
all_extended_vars = independent_vars + [f"{var}_missing" for var in independent_vars]

skip_result = False
for var in all_extended_vars:
    if var not in all_variables or avg_weights.get(var, 0) == 0:
        skip_result = True
        break

if not skip_result:
    results.append(weights_dict)
else:
    print("–ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –≤–µ—Å–æ–≤ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö")
```

### –û–ø—Ü–∏—è 3: –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–ê–Ø - –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥

–î–æ–±–∞–≤–∏—Ç—å –≤ –æ–±–∞ —Ñ–∞–π–ª–∞ –æ–ø—Ü–∏—é –≤—ã–±–æ—Ä–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è:
- `strict_mode=False` - –¥–æ–±–∞–≤–ª—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç –≤–µ—Å–∞ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 0)
- `strict_mode=True` - —Ç—Ä–µ–±–æ–≤–∞—Ç—å –≤–µ—Å–∞ –¥–ª—è –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

---

## üìù –í—ã–≤–æ–¥

**–ü—Ä–∏—á–∏–Ω–∞ —Ä–∞–∑–ª–∏—á–∏–π:**
1. –í –±–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å—Ç—Ä–æ–≥–∞—è** –ø—Ä–æ–≤–µ—Ä–∫–∞ - –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∏–º–µ–µ—Ç –≤–µ—Å–æ–≤ –≤–æ –≤—Å–µ—Ö –∏–º–ø—É—Ç–∞—Ü–∏—è—Ö, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è
2. –í imputations_v2 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–º—è–≥–∫–∞—è** –ª–æ–≥–∏–∫–∞ - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤–µ—Å–∞ = 0

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–ü—Ä–∏–≤–µ—Å—Ç–∏ –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞ –∫ –µ–¥–∏–Ω–æ–π –ª–æ–≥–∏–∫–µ - –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ –∫ **–º—è–≥–∫–æ–º—É** –≤–∞—Ä–∏–∞–Ω—Ç—É —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º 0 –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤–µ—Å–æ–≤.

